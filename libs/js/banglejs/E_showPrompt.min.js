(function(u,a){function n(){g.reset().setFont("6x8",2).setFontAlign(0,-1);var f=Bangle.appRect.y,e=g.getWidth(),k=g.getHeight()-f,q=g.getFontHeight(),p=g.wrapString(a.title,e-2),r=g.wrapString(u||"",e-2),b=f+(k+(p.length-r.length)*q)/2-24;a.img&&(k=g.imageMetrics(a.img),g.drawImage(a.img,(e-k.width)/2,b-k.height/2),b+=4+k.height/2);p&&g.setColor(g.theme.fgH).setBgColor(g.theme.bgH).clearRect(0,f,e-1,f+4+p.length*q).drawString(p.join("\n"),e/2,f+2);g.setColor(g.theme.fg).setBgColor(g.theme.bg).drawString(r.join("\n"),
e/2,b);b+=r.length*q+32;var l=0;g.setFontAlign(0,0);m.forEach(h=>l+=16+g.stringWidth(h));l>e&&(g.setFont("6x8"),l=0,m.forEach(h=>l+=16+g.stringWidth(h)));var c=(e-l)/2;m.forEach((h,v)=>{var t=g.stringWidth(h);c+=(16+t)/2;var d=2+t/2;d=[c-d,b-12,c+d,b-12,c+d+4,b-8,c+d+4,b+8,c+d,b+12,c-d,b+12,c-d-4,b+8,c-d-4,b-8,c-d,b-12];g.setColor(v==a.selected?g.theme.bgH:g.theme.bg).fillPoly(d).setColor(v==a.selected?g.theme.fgH:g.theme.fg).drawPoly(d).drawString(h,c,b+1);c+=(16+t)/2});Bangle.setLCDPower(1)}a||
(a={});a.buttons||(a.buttons={Yes:!0,No:!1});var m=Object.keys(a.buttons);a.selected||(a.selected=0);g.reset().clearRect(Bangle.appRect);if(!u)return Bangle.setUI(),Promise.resolve();n();return new Promise(f=>{Bangle.setUI({mode:"leftright",remove:a.remove,redraw:n,back:a.back},e=>{0>e?0<a.selected&&(a.selected--,n()):0<e?a.selected<m.length-1&&(a.selected++,n()):(E.showPrompt(),f(a.buttons[m[a.selected]]))})})})